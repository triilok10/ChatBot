@{
    ViewData["Title"] = "AIDashBoard";
    Layout = null;
}
<!-- Add Bootstrap CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />

<style>
    /* Custom Styles */
    body {
        background-color: #ecf0f1;
        display: flex;
        height: 100vh;
        overflow: hidden;
        margin: 0;
    }

    .left-sidebar {
        background-color: #2c3e50;
        color: white;
        padding: 20px;
        position: fixed;
        top: 0;
        left: 0;
        width: 20%;
        height: 100vh; 
        overflow-y: auto; 
        z-index: 100;
    }

    .chat-section {
        margin-left: 20%; 
        width: 80%;
        height: 100vh; 
        overflow-y: scroll; 
    }

    .chat-box {
        background-color: white;
        padding: 15px;
        height: 60%;
        overflow-y: auto;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .message {
        margin-bottom: 15px;
    }

    .user-message {
        background-color: #3498db;
        color: white;
        padding: 10px;
        border-radius: 5px;
        max-width: 70%;
        word-wrap: break-word;
    }

    .bot-message {
        background-color: #95a5a6;
        color: white;
        padding: 10px;
        border-radius: 5px;
        max-width: 70%;
        word-wrap: break-word;
    }

    .ai-assistant-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #3498db;
        color: white;
        padding: 12px 20px; 
        border-radius: 8px; 
        font-size: 18px;
        border: none;
        cursor: pointer;
        z-index: 1000;
        transition: background-color 0.3s ease;
    }

        .ai-assistant-btn:hover {
            background-color: #2980b9;
        }

    .ai-assistant-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }

    .modal-content {
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        width: 400px;
        max-height: 70%;
        overflow-y: auto;
        text-align: center;
    }

    .modal-chat-box {
        margin-bottom: 20px;
        background-color: #ecf0f1;
        padding: 15px;
        height: 200px;
        overflow-y: auto;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    #modal-user-message {
        width: 70%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    #modal-send-btn {
        width: 20%;
        padding: 10px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .close-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 30px;
        cursor: pointer;
        color: #555;
    }

        .close-btn:hover {
            color: #3498db;
        }

    /* Custom media query */
    @@media (max-width: 768px) {
        .left-sidebar {
            width: 100%;
            height: auto;
        }

        .chat-section {
            margin-left: 0;
            width: 100%;
        }

        .chat-box {
            height: 50%;
        }
    }
</style>

<!-- Main container -->
<div class="container-fluid d-flex flex-column flex-md-row">
    <!-- Left Sidebar -->
    <div class="left-sidebar col-12 col-md-3">
        <div class="user-info">
            <h2>Welcome, <span id="username">Guest</span></h2>
            <button id="login-btn" class="btn btn-primary w-100 mb-2">Login</button>
            <button id="logout-btn" class="btn btn-danger w-100" style="display: none;">Logout</button>
        </div>
        <div class="status mt-4">
            <h3>Bot Status:</h3>
            <p id="bot-status">Online</p>
        </div>
    </div>

    <!-- Right Side - Chatbot Interaction Section -->
    <div class="chat-section col-12 col-md-9">
        <div class="chat-header text-center">
            <h2>Chat with Assistant</h2>
        </div>
        <div class="chat-box" id="chat-box">
            <!-- Chat messages will be displayed here -->
        </div>
        <div class="chat-input d-flex justify-content-between mt-3">
            <input type="text" id="user-message" class="form-control me-2" placeholder="Type a message..." />
            <button id="send-btn" class="btn btn-primary"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
</div>

<!-- AI Assistant Fixed Button -->
<button id="ai-assistant-btn" class="ai-assistant-btn">
    AI Assistant
</button>

<!-- AI Assistant Popup Modal -->
<div id="ai-assistant-modal" class="ai-assistant-modal d-flex">
    <div class="modal-content">
        <span id="close-modal" class="close-btn">&times;</span>
        <h2>How can I assist you?</h2>
        <div class="modal-chat-box" id="modal-chat-box"></div>
        <input type="text" id="modal-user-message" class="form-control mb-2" placeholder="Ask me something..." />
        <button id="modal-send-btn" class="btn btn-primary w-100">Send</button>
    </div>
</div>

<!-- Include Bootstrap JS and other required libraries -->
<script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>

<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        const loginButton = document.getElementById('login-btn');
        const logoutButton = document.getElementById('logout-btn');
        const usernameElement = document.getElementById('username');
        const chatBox = document.getElementById('chat-box');
        const sendButton = document.getElementById('send-btn');
        const userMessageInput = document.getElementById('user-message');

        const aiAssistantButton = document.getElementById('ai-assistant-btn');
        const aiAssistantModal = document.getElementById('ai-assistant-modal');
        const closeModalButton = document.getElementById('close-modal');
        const modalChatBox = document.getElementById('modal-chat-box');
        const modalSendButton = document.getElementById('modal-send-btn');
        const modalUserMessageInput = document.getElementById('modal-user-message');

        // Handle login/logout buttons
        loginButton.addEventListener('click', () => {
            usernameElement.textContent = 'John Doe';  
            loginButton.style.display = 'none';
            logoutButton.style.display = 'block';
        });

        logoutButton.addEventListener('click', () => {
            usernameElement.textContent = 'Guest';
            logoutButton.style.display = 'none';
            loginButton.style.display = 'block';
        });

        // Send message to the main bot
        sendButton.addEventListener('click', async () => {
            const userMessage = userMessageInput.value.trim();
            if (userMessage) {
                appendMessage(userMessage, 'user');
                userMessageInput.value = '';

                const botMessage = await mockBotResponse(userMessage);
                appendMessage(botMessage, 'bot');
            }
        });

        // Open AI Assistant Modal
        aiAssistantButton.addEventListener('click', () => {
            aiAssistantModal.style.display = 'flex'; 
        });

        // Close the AI Assistant Modal
        closeModalButton.addEventListener('click', () => {
            aiAssistantModal.style.display = 'none';  
        });

        // Handle modal send button
        modalSendButton.addEventListener('click', async () => {
            const userMessage = modalUserMessageInput.value.trim();
            if (userMessage) {
                appendMessageInModal(userMessage, 'user');
                modalUserMessageInput.value = '';

                const botMessage = await mockBotResponse(userMessage);
                appendMessageInModal(botMessage, 'bot');
            }
        });

        // Append messages in the main chat box
        const appendMessage = (message, sender) => {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            const messageText = document.createElement('div');
            messageText.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
            messageText.textContent = message;
            messageDiv.appendChild(messageText);
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        };

        // Append messages in the modal
        const appendMessageInModal = (message, sender) => {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            const messageText = document.createElement('div');
            messageText.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
            messageText.textContent = message;
            messageDiv.appendChild(messageText);
            modalChatBox.appendChild(messageDiv);
            modalChatBox.scrollTop = modalChatBox.scrollHeight;
        };

        // Mockup function to simulate a Rasa message response
        const mockBotResponse = (userMessage) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    resolve(`You said: "${userMessage}"`);
                }, 1000);
            });
        };
    });
</script>
